<!DOCTYPE html>
<html>
<head>
  <!-- META DATA -->
	<meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Free Responsive Html5 Templates">
    <meta name="author" content="">

	<title>OpenHouse - Houses for Rent</title>
  
	<!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css"  type="text/css">
	
	<!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/lightbox.css">
	
	<!-- Custom Fonts -->
    <link rel="stylesheet" href="font-awesome-4.4.0/css/font-awesome.min.css"  type="text/css">
	<link href='http://fonts.googleapis.com/css?family=Asap:400,700' rel='stylesheet' type='text/css'>
	<!--搜索框的样式-->
	<link rel="stylesheet" href="css/search-box.css">
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="js/html5shiv.js"></script>
        <script src="js/respond.min.js"></script>
    <![endif]-->
	
</head>

 <body>
<header>

	<!-- /////////////////////////////////////////Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <h1 class="navbar-brand page-scroll">
					<a href="#page-top">OpenHouse</a>
				</h1>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
               <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li>
                        <a class="page-scroll" href="index.html">Home</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="products.html">Product</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="projects.html">Project</a>
                    </li>
                    <li>
                        <a class="page-scroll" href="productManage.html">background</a>
                    </li>
				    <li>
					   <a class="page-scroll" href="about.html">About</a>
				    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>
	<!-- Navigation 为了美观，已经删除，若有需要可以往主页获取-->
	<!--<div class="box-shadow">

	</div>-->
</header>

	<!-- 商品内容 -->
	<div id="page-content">
		<!-- ////////////Content Box -->
		<section class="box-content box-2" id="services">
			<div class="container">
				<div class="row heading">
					<div class="col-lg-12">
						<h2>TOP HOLIDAY DESTINATIONS</h2>
						<hr>
						<div class="intro">Lorem ipsum dolor sit amet</div>
						<div class="search">
							<div class="search-content">
								<input type="search" id="searchContent" placeholder="search" >
							</div>
							<div class="search-button">
								<input type="button" id="searchButton" value="搜索" onclick="search()">
							</div>
						</div>
					</div>
				</div>
				<!--分类-->
				<div class="categories">
					<ul class="cat">
						<li>
                            <!--类别通过ajax获取-->
							<ol class="type list-inline" id="sorts">

							</ol>
						</li>
					</ul>
					<div class="clearfix"></div>
				</div>
                <!--商品内容通过ajax获取-->
				<div class="row">
					<div class="portfolio-items" id="products">

					</div>
				</div>
			</div>
		</section>
	</div>
    <!--分页信息-->
	<div class="row clearfix">
		<div class="col-md-12 column" style="text-align: center">
			<ul class="pagination pagination-lg" id="paging">

			</ul>
		</div>
	</div>
	<!-- FOOTER -->
	<footer>
		<div class="wrap-footer">
			<div class="container">
				<div class="row"> 
					<div class="col-footer col-md-4">
						<h2 class="footer-title">About Us</h2>
						<div class="textwidget">Aenean feugiat in ante et blandit. Vestibulum posuere molestie risus, ac interdum magna porta non. Pellentesque rutrum fringilla elementum. Curabitur tincidunt porta lorem vitae accumsan. <br> <br> 
						Aenean feugiat in ante et blandit. Vestibulum posuere molestie risus, ac interdum magna porta non. Pellentesque rutrum fringilla elementum. Curabitur tincidunt porta lorem vitae accumsan.</div>
					</div> 
					<div class="col-footer col-md-4 widget_recent_entries">
						<h2 class="footer-title">Recent Posts</h2>
						<ul>
							<li><a href="#">MOST VISITED COUNTRIES</a></li>
							<li><a href="#">5 PLACES THAT MAKE A GREAT HOLIDAY</a></li>
							<li><a href="#">PEBBLE TIME STEEL IS ON TRACK TO SHIP IN JULY</a></li>
							<li><a href="#">STARTUP COMPANY&#8217;S CO-FOUNDER TALKS ON HIS NEW PRODUCT</a></li>
						</ul>
					</div>
					<div class="col-footer col-md-4">
						<h2 class="footer-title">NEWS LETTER</h2>
						If you want to receive our latest news send directly to your email, please leave your email address bellow. Subscription is free and you can cancel anytime.
						<div>
							<input type="text" name="your-name" id="email" value="" size="40" placeholder="Your Email" required/>
							<input type="submit" value="SUBSCRIBE" class="btn btn-3" onclick="subscribe()"/>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="bottom-footer">
			<div class="container">
				<div class="row">
					<div class="col-md-4">
						<p>Copyright 20xx - More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></p>
					</div>
					<div class="col-md-4">
						<ul class="list-inline social-buttons">
							<li><a href="#"><i class="fa fa-twitter"></i></a>
							</li>
							<li><a href="#"><i class="fa fa-facebook"></i></a>
							</li>
							<li><a href="#"><i class="fa fa-linkedin"></i></a>
							</li>
							<li><a href="#"><i class="fa fa-pinterest"></i></a>
							</li>
						</ul>
					</div>
					<div class="col-md-4">
						<ul class="list-inline quicklinks">
							<li><a href="#">Privacy Policy</a>
							</li>
							<li><a href="#">Terms of Use</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</footer>
  
	<!-- jQuery -->
	<script type="text/javascript" src="js/jquery-2.1.1.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	
	<!-- Custom Theme JavaScript -->
	<script src="js/agency.js"></script>

	<!-- Plugin JavaScript -->
	<script src="js/jquery.easing.min.js"></script>
	<script src="js/classie.js"></script>
	<script src="js/cbpAnimatedHeader.js"></script>
	
	<script src="js/lightbox-plus-jquery.min.js"></script>
	<script type="text/javascript" src="js/wow.min.js"></script>
	<script type="text/javascript" src="js/jquery.isotope.js"></script>
	<script type="text/javascript" src="js/main.js"></script>

	<!-- carousel -->
	<script src="owl-carousel/owl.carousel.js"></script>
    <!--引进自己写的一些js-->
    <script type="text/javascript" src="mine-js/until.js"></script>
    <!--获取商品的种类个数-->
    <script type="text/javascript">
		//获取url参数的方法
		function getQueryString(name)
		{
			var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
			var r = window.location.search.substr(1).match(reg);//search,查询？后面的参数，并匹配正则
			if(r!=null)
				return  unescape(r[2]);
			return null;
		}
		//查找到全部分类
        findAllCategory();
        function findAllCategory(){
            $.ajax({
                url : "/project/foreground/categorys",
                type : "get",
                //发送的数据
                data :"",
                contentType : "application/json;charset=UTF-8",
                dataType : "json",
                async : false,
                success : function(data){
                    //商品的类别
                    var categorys = "<li><a href='#' data-filter='*' class='active' onclick='showPaging()'>All</a></li>";
                    if(data.status=0)
                        alert("服务器出现问题") ;
                    else{
                        for (var i=0;i<data.data.length;i++){                    
                            categorys+="<li><a  id='"+data.data[i].sort+"' onclick='hidePaging(this)' data-filter='."+data.data[i].sort+"'>"+data.data[i].sort+"</a></li>";
                        }
                    }
                    $("#sorts").html(categorys);
                }
            });
        }
    </script>

    <!--分页功能-->
    <script>
        //目前的页码数
        var currentPage = 1;
        //上一页
        function previous() {
            currentPage = currentPage-1;
            findAllProduct();
        }
        //下一页
        function next() {
            currentPage= currentPage+1;
            findAllProduct();
        }
        //跳转到指定页码页面
        function goPage(e) {
            currentPage = $(e).text();
            findAllProduct();
        }
    </script>
	//解决模板的bug
	<script>
		//为了解决模板的bug，在点击分类的时候直接刷新页面 然后根据url中的category来判断
		//隐藏分页信息
		function hidePaging(e) {
			$("#paging").css('visibility','hidden');
			if (getQueryString("category") == null){
				var category = e.id;
				window.location.href = "products.html?category="+category;
			}
		}
		//显示分页信息
		function showPaging() {
			$("#paging").css('visibility','visible');
			window.location.href = "products.html";
		}
	</script>
    <!--展示商品-->
    <script type="text/javascript">
		var pageSize = 9;
		if (getQueryString("category") == null){
			pageSize = 9;
			findAllProduct();
		} else {
			pageSize = 1000;
			findAllProduct();
		}
        function findAllProduct(){
            $.ajax({
                url : "/project/foreground/products?currentPage="+currentPage+"&pageSize="+pageSize,
                type : "get",
                //发送的数据
                data :"",
                contentType : "application/json;charset=UTF-8",
                dataType : "json",
                async : false,
                success : function(data){
                    //打印商品内容
                    var products = "";
                    if(data.status=0)
                        alert("服务器出现问题")
                    else{
                        for (var i=0;i<data.data.list.length;i++){
                            products+="<div class='col-sm-6 col-md-4 col-lg-4 "+data.data.list[i].category+"'>"+
                                        "<div class='post'>"+
                                            "<div class='item-container' onclick='transfer("+data.data.list[i].id+")'>"+
                                                "<div class='item-caption'>"+
                                                    "<div class='item-caption-inner'>"+
                                                        "<div class='item-caption-inner1'>"+
															"<a class='example-image-link' href='/project/foreground/product/"+data.data.list[i].id+"' data-lightbox='example-set' data-title='Click the right half of the image to move forward.'>"+
																"<i class='fa fa-search'></i>"+
															"</a>"+
                                                        "</div>"+
                                                    "</div>"+
                                                "</div>"+
                                                "<img src='"+data.data.list[i].img.mainImg+"' style='width: 425px;height: 275px'/> "+
                                            "</div>"+
                                            "<span>"+data.data.list[i].name+"</span>"+
                                        "</div>"+
                                      "</div>";
                        }
                    }
                    //输出商品信息
                    $("#products").html(products);
                    //分页情况
                    currentPage=data.data.pageNum;//更新当前页面的页码
					var paging = "";
					//不是第一页时才显示上一页按钮
					if(currentPage!=1){
					    paging+="<li><a onclick='previous()'>Prev</a></li>";
                    }
					for (var i = 1;i<=data.data.pages;i++){
					    if (i==currentPage){
                            paging+="<li><a onclick='goPage(this)' style='background-color: #2b90d9;color: white'>"+i+"</a></li>";
                        }
					    else {
                            paging+="<li><a onclick='goPage(this)'>"+i+"</a></li>";
                        }
					}
					//不是最后一页才显示下一页按钮
                    if(currentPage!=data.data.pages){
                        paging+="<li><a onclick='next()'>next</a></li>"
                    }
                    //打印分页信息
                    $("#paging").html(paging);
                }
            });
        }
    </script>
    <!--插件-->
 	<script>
        //进入商品详情页面
		function transfer(id) {
			console.log("鼠标点击事件已触发");
			window.location.href="product.html?id="+id;
		}
		//点击搜索
		$("#searchButton").click(function(){
			var searchText= jQuery.trim($("#searchContent").val());
			var searchUrl =encodeURI("SearchResult2.html?searchText="+searchText);   //使用encodeURI编码
			window.location.href =searchUrl;
		})
	</script>
</body>
</html>